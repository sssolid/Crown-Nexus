<!-- src/components/form/FormTextField.vue --><template><div class="form-field" :class="{ 'form-field--error': hasError }"><base-text-field v-model="localModelValue" :label="label" :hint="hint" :placeholder="placeholder" :error-messages="errorMessage" :rules="validationRules" :required="required" :disabled="disabled" :readonly="readonly" :clearable="clearable" :density="density" :prepend-icon="prependIcon" :append-icon="appendIcon" :variant="variant" :type="type" :autocomplete="autocomplete" v-bind="$attrs" @blur="validate" @update:model-value="onInput" ><template v-for="(_, slot) in $slots" #[slot]="scope"><slot :name="slot" v-bind="scope || {}" /></template></base-text-field></div></template><script setup lang="ts">import{ref,computed,watch,onMounted}from 'vue' import BaseTextField from '@/components/base/BaseTextField.vue' interface Props{modelValue:string|number label?:string hint?:string placeholder?:string required?:boolean disabled?:boolean readonly?:boolean clearable?:boolean validateOnMount?:boolean validateOnInput?:boolean densityProps?:'default'|'comfortable'|'compact' variant?:string type?:string prependIcon?:string appendIcon?:string autocomplete?:string validationRules?:Array<(value:any)=>true|string>validator?:(value:any)=>{valid:boolean;message?:string}}const props=withDefaults(defineProps<Props>(),{label:'',hint:'',placeholder:'',required:false,disabled:false,readonly:false,clearable:false,validateOnMount:false,validateOnInput:true,density:'comfortable',variant:'outlined',type:'text',prependIcon:'',appendIcon:'',autocomplete:undefined,validationRules:()=>[],validator:undefined,})const emit=defineEmits(['update:modelValue','validation','blur','focus','change','input'])const localModelValue=computed({get:()=>props.modelValue,set:(value)=>emit('update:modelValue',value)})const errorMessage=ref<string>('')const hasError=computed(()=>errorMessage.value!=='')const isValid=ref<boolean|null>(null)const validationRules=computed(()=>{const rules=[...props.validationRules]if(props.required){rules.unshift((v:any)=>!!v||`${props.label || __STRING_22__} is required`)}return rules})const validate=()=>{for(const rule of validationRules.value){const result=rule(localModelValue.value)if(result!==true){errorMessage.value=result isValid.value=false emit('validation',{valid:false,message:result})return false}}if(props.validator){const{valid,message}=props.validator(localModelValue.value)if(!valid){errorMessage.value=message||'Invalid input' isValid.value=false emit('validation',{valid:false,message:errorMessage.value})return false}}errorMessage.value='' isValid.value=true emit('validation',{valid:true})return true}const onInput=(value:any)=>{if(props.validateOnInput){validate()}emit('input',value)}onMounted(()=>{if(props.validateOnMount){validate()}})watch(()=>props.modelValue,()=>{if(props.validateOnInput){validate()}})defineExpose({validate,isValid,errorMessage,})</script><style scoped>.form-field{margin-bottom:16px}</style>